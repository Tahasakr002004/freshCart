<div>
 <div class="mb-6 flex items-center justify-between">
  <div>
    <h2 class="text-2xl font-semibold text-gray-800">
      Admin Dashboard
    </h2>
    <p class="mt-1 text-sm text-gray-600">
      <span class="font-medium">Logged in as:</span>
      <span class="ml-1">{{ adminName }}</span>
    </p>
  </div>

  <button
    (click)="logout()"
    class="inline-flex items-center px-4 py-2 rounded-md bg-red-500 text-white text-sm font-medium hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2"
  >
    Logout
  </button>
</div>

 <section
  class="mb-8 border border-blue-500 rounded-lg p-6 bg-white shadow-sm max-w-xl"
>
  <h3 class="text-xl font-semibold mb-4 text-blue-700">Add Product</h3>

  <form [formGroup]="productForm" (ngSubmit)="createProduct()" class="space-y-4">
    <div>
      <label class="block text-sm font-medium text-gray-700">Name</label>
      <input
        type="text"
        formControlName="name"
        class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm
               focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
      />
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700">Price</label>
      <input
        type="number"
        formControlName="price"
        step="0.01"
        class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm
               focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
      />
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700">
        Image (from backend/public/freshcartImages)
      </label>

      <select
        formControlName="imageFileName"
        class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm
              bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
      >
        <option value="" disabled>Select an image</option>
        <option *ngFor="let file of availableImages" [value]="file">
          {{ file }}
        </option>
      </select>

      <p *ngIf="productForm.value.imageFileName" class="mt-1 text-xs text-gray-500">
        Will be served as:
        <code>/images/{{ productForm.value.imageFileName }}</code>
      </p>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700">Stock</label>
      <input
        type="number"
        formControlName="stock"
        class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm
               focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
      />
    </div>

    <button
      type="submit"
      [disabled]="productForm.invalid || creating"
      class="mt-2 inline-flex items-center px-4 py-2 rounded-md text-sm font-medium
             text-white bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300
             disabled:cursor-not-allowed transition"
    >
      {{ creating ? 'Creating...' : 'Create Product' }}
    </button>

  </form>

  <div
    *ngIf="createError"
    class="text-red-600 text-sm mt-3"
  >
    {{ createError }}
  </div>
</section>


 <section class="mt-6 bg-white border border-gray-200 rounded-lg shadow-sm p-4">
  <div class="flex items-center justify-between mb-4">
    <h3 class="text-lg font-semibold text-gray-800">Products</h3>
    <span
      *ngIf="!loading && products.length"
      class="text-sm text-gray-500"
    >
      {{ products.length }} products
    </span>
  </div>

  <div *ngIf="loading" class="text-sm text-gray-500">
    Loading products...
  </div>

  <div *ngIf="loadError" class="text-sm text-red-600 mb-3">
    {{ loadError }}
  </div>

  <div *ngIf="editingProduct" class="mb-4 rounded-lg border border-amber-300 bg-amber-50 p-4">
    <div class="flex items-center justify-between mb-3">
      <h4 class="text-sm font-semibold text-amber-800">
        Edit Product
      </h4>
      <button
        type="button"
        (click)="cancelEdit()"
        class="text-xs text-amber-700 hover:text-amber-900"
      >
        Cancel
      </button>
    </div>

    <form [formGroup]="editForm" (ngSubmit)="updateProduct()" class="grid gap-3 md:grid-cols-2">
      <div>
        <label class="block text-xs font-medium text-gray-700">Name</label>
        <input
          type="text"
          formControlName="name"
          class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm
                 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"
        />
      </div>

      <div>
        <label class="block text-xs font-medium text-gray-700">Price</label>
        <input
          type="number"
          step="0.01"
          formControlName="price"
          class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm
                 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"
        />
      </div>

      <div>
        <label class="block text-xs font-medium text-gray-700">Stock</label>
        <input
          type="number"
          formControlName="stock"
          class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm
                 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"
        />
      </div>

      <div>
        <label class="block text-xs font-medium text-gray-700">Image</label>
        <select
          formControlName="imageFileName"
          class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm
                bg-white focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"
        >
          <option value="">Keep current image</option>
          <option *ngFor="let file of availableImages" [value]="file">
            {{ file }}
          </option>
        </select>
        <p *ngIf="editingProduct?.imageUrl" class="mt-1 text-xs text-gray-500">
          Current:
          <code>{{ editingProduct.imageUrl }}</code>
        </p>
      </div>

      <div class="md:col-span-2 flex items-center gap-2">
        <button
          type="submit"
          [disabled]="editForm.invalid || updating"
          class="inline-flex items-center px-4 py-2 rounded-md text-sm font-medium
                 text-white bg-amber-600 hover:bg-amber-700 disabled:bg-amber-300
                 disabled:cursor-not-allowed transition"
        >
          {{ updating ? 'Saving...' : 'Save Changes' }}
        </button>
        <button
          type="button"
          (click)="cancelEdit()"
          class="inline-flex items-center px-3 py-2 rounded-md text-sm font-medium
                 text-amber-700 border border-amber-300 hover:bg-amber-100"
        >
          Cancel
        </button>
      </div>
    </form>

    <div *ngIf="updateError" class="text-red-600 text-sm mt-2">
      {{ updateError }}
    </div>
  </div>

  <div *ngIf="!loading && products.length > 0" class="overflow-x-auto">
    <table class="min-w-full text-sm text-left border-collapse">
      <thead>
        <tr class="bg-gray-50">
          <th class="px-3 py-2 font-medium text-gray-600 border-b">ID</th>
          <th class="px-3 py-2 font-medium text-gray-600 border-b">Name</th>
          <th class="px-3 py-2 font-medium text-gray-600 border-b">Price</th>
          <th class="px-3 py-2 font-medium text-gray-600 border-b">Stock</th>
          <th class="px-3 py-2 font-medium text-gray-600 border-b">Image URL</th>
          <th class="px-3 py-2 font-medium text-gray-600 border-b">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let p of products"
          class="border-b last:border-b-0 hover:bg-gray-50"
        >
          <td class="px-3 py-2 text-gray-700 break-all">
            {{ p._id }}
          </td>
          <td class="px-3 py-2 text-gray-800">
            {{ p.name }}
          </td>
          <td class="px-3 py-2 text-gray-700">
            {{ p.price }}
          </td>
          <td class="px-3 py-2 text-gray-700">
            {{ p.stock }}
          </td>
          <td class="px-3 py-2 text-gray-700 break-all">
            {{ p.imageUrl }}
          </td>
          <td class="px-3 py-2">
            <button
              (click)="startEdit(p)"
              class="mr-2 inline-flex items-center px-3 py-1 rounded-md border border-blue-500 text-blue-600 text-xs font-medium hover:bg-blue-50"
            >
              Edit
            </button>
            <button
              (click)="deleteProduct(p)"
              [disabled]="deletingId === p._id"
              class="inline-flex items-center px-3 py-1 rounded-md border border-red-500 text-red-600 text-xs font-medium hover:bg-red-50 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              {{ deletingId === p._id ? 'Deleting...' : 'Delete' }}
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div
    *ngIf="!loading && products.length === 0"
    class="text-sm text-gray-500"
  >
    No products found.
  </div>
</section>





<section class="mt-6 bg-white border border-gray-200 rounded-lg shadow-sm p-4">
  <div class="flex items-center justify-between mb-4">
    <h3 class="text-lg font-semibold text-gray-800">Users</h3>

    <span *ngIf="!loadingUsers && Users.length" class="text-sm text-gray-500">
      {{ Users.length }} Users
    </span>
  </div>


  <div *ngIf="loadingUsers" class="text-sm text-gray-500">Loading Users...</div>


  <div *ngIf="loadError" class="text-sm text-red-600 mb-3">{{ loadError }}</div>


  <div *ngIf="!loadingUsers && Users && Users.length > 0" class="overflow-x-auto">

    <table class="min-w-full text-sm text-left border-collapse">
      <thead>
        <tr class="bg-gray-50">
          <th class="px-3 py-2 font-medium text-gray-600 border-b">ID</th>
          <th class="px-3 py-2 font-medium text-gray-600 border-b">First Name</th>
          <th class="px-3 py-2 font-medium text-gray-600 border-b">Last Name</th>
          <th class="px-3 py-2 font-medium text-gray-600 border-b">Email</th>
          <!-- <th class="px-3 py-2 font-medium text-gray-600 border-b">Password</th> -->
          <th class="px-3 py-2 font-medium text-gray-600 border-b">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let U of Users" class="border-b last:border-b-0 hover:bg-gray-50">
          <td class="px-3 py-2 text-gray-700 break-all">{{ U._id }}</td>
          <td class="px-3 py-2 text-gray-800">{{ U.firstName }}</td>
          <td class="px-3 py-2 text-gray-700">{{ U.lastName }}</td>
          <td class="px-3 py-2 text-gray-700">{{ U.email }}</td>
          <!-- <td class="px-3 py-2 text-gray-700 break-all">{{ U.password }}</td> -->
          <td class="px-3 py-2">
            <button
              (click)="deleteUser(U)"
              [disabled]="deletingId === U._id"
              class="inline-flex items-center px-3 py-1 rounded-md border border-red-500 text-red-600 text-xs font-medium hover:bg-red-50 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              {{ deletingId === U._id ? 'Deleting...' : 'Delete' }}
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>




</section>



</div>
